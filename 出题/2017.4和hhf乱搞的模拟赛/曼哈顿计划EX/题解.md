## 曼哈顿计划EX 题解
- 知识需求：等价流树，带权并查集（不必要）
- 我们考虑题目中的那个乱七八糟的描述，尝试把它复述一下
- 使得任意两点$u,v\in V_{1}$都至少有k条互不相交的u到v的链（互不相交定义为：没有重复的边，可以重复有重复的点）
- 转述一下就是
- 使得任意两点$u,v\in V_{1}$不连通都至少需要切断k条边
- 就是个最小割（最大流的建模也很显然）咯
- 然后询问就转化成了：你要选出的一些点满足工作需求，同时在原图中把这些点割成两部分所需的代价最大
- 这个东西长得就很像全局最小割，但是我们询问的不是整个图，不妨把他称作部分最小割
- 我们把这张图的等价流树构建出来，则在图中选出一些点的部分最小割的权值，等于这些点在等价流树上所形成的导出子树上所有边的最小值，证明如下。
- 我们不妨证明，部分最小割必定被包含在等价流树上的$u\in V_{1}$的导出子树中，且导出子树上的边权都大于等于部分最小割
- 枚举两点$u,v\in V_{1}$，求一个u到v的最小割，则u到v的最小割就是等价流树上u到v的边权最小值，显然这些边都属于导出子树。且这个导出子树上所有的边，都会在某次枚举中取到，且显然任何一个最小割都能在某次枚举中取到，所以部分最小割必定被包含在导出子树中。
- 假设导出子树包含了比部分最小割权值更小的边，不妨取这条边的两端做一个最小割，显然这是一个满足条件的部分割，则原来的部分最小割不是最小割
- 然后还可以发现，我们对于每个询问选出的一些点一定在等价流树上构成一个点联通快，证明是平凡的，如下
- 由于原图是联通的，导出子图必然联通。如果树上的节点构成了多个联通块，不妨把属于导出子图而不属于联通块的节点都加入答案，显然部分最小割不会更差且总的工作能力上升了
- 那么我们建出等价流树，把等价流树上的边按权值从大到小排序，把询问从小到大排序，用带权并查集维护即可，最终复杂度为$O(n^4+q)$，事实上，由于等价流树渐进复杂度过差，询问部分随便怎么处理都行，但这么写比较优雅